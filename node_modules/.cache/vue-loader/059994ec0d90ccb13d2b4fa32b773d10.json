{"remainingRequest":"F:\\vscode\\gocode\\cloudMusic\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\vscode\\gocode\\cloudMusic\\src\\components\\context\\phoneLogin\\PhoneLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\vscode\\gocode\\cloudMusic\\src\\components\\context\\phoneLogin\\PhoneLogin.vue","mtime":1605347186000},{"path":"F:\\vscode\\gocode\\cloudMusic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\vscode\\gocode\\cloudMusic\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\vscode\\gocode\\cloudMusic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\vscode\\gocode\\cloudMusic\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBuYXZiYXIgZnJvbSAiY29tcG9uZW50cy9jb21tb24vbmF2YmFyL25hdmJhciI7CmltcG9ydCBSZWdpc3RlciBmcm9tICJjb21wb25lbnRzL2NvbnRleHQvcmVnaXN0ZXIvUmVnaXN0ZXIiOwppbXBvcnQgeyBwaG9uZUxvZ2luLCBsb2dpblN0YXRlIH0gZnJvbSAibmV0d29yay9sb2dpbiI7IC8vIOe9kee7nOivt+axggoKaW1wb3J0IHsgZ2V0VXNlckRldGFpbCwgZ2V0VXNlclBsYXlMaXN0IH0gZnJvbSAibmV0d29yay91c2VyIjsgLy8g55So5oi35L+h5oGvCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlBob25lTG9naW4iLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0ZWw6ICIiLCAvLyDmiYvmnLrlj7cKICAgICAgcGFzc3dvcmQ6ICIiLCAvLyDlr4bnoIEKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsKICAgIH0sCiAgICAvLyDnmbvpmYYKICAgIGxvZ2luKCkgewogICAgICB2YXIgcmVnID0gL14xWzMtOF1bMC05XXs5fSQvOwogICAgICBpZiAocmVnLnRlc3QodGhpcy50ZWwpKSB7CiAgICAgICAgdGhpcy4kbG9hZGluZy5sb2FkaW5nU2hvdygpOwogICAgICAgIHBob25lTG9naW4odGhpcy50ZWwsIHRoaXMucGFzc3dvcmQpLnRoZW4oCiAgICAgICAgICAocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmNvb2tpZSA9IHJlcy5kYXRhLmNvb2tpZTsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMuJHRvYXN0LnNob3coIueZu+W9leaIkOWKn++8gSIsIDE5MDApOwogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbygtMik7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS5uaWNrTmFtZSA9IHJlcy5kYXRhLnByb2ZpbGUubmlja25hbWU7IC8vIOeUqOaIt+WQjQogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnByb2ZpbGUuYXZhdGFyVXJsID0gcmVzLmRhdGEucHJvZmlsZS5hdmF0YXJVcmw7IC8vIOWktOWDjwogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnByb2ZpbGUudXNlcklkID0gcmVzLmRhdGEucHJvZmlsZS51c2VySWQ7IC8vIGlkCiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS5iYWNrZ3JvdW5kVXJsID0KICAgICAgICAgICAgICAgIHJlcy5kYXRhLnByb2ZpbGUuYmFja2dyb3VuZFVybDsgLy8g6IOM5pmv5Zu+CgogICAgICAgICAgICAgIHRoaXMudGVsID0gIiI7CiAgICAgICAgICAgICAgdGhpcy5wYXNzd29yZCA9ICIiOwogICAgICAgICAgICAgIGdldFVzZXJEZXRhaWwodGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS51c2VySWQpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS5sZXZlbCA9IHJlcy5kYXRhLmxldmVsOwogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS5saXN0ZW5Tb25ncyA9IHJlcy5kYXRhLmxpc3RlblNvbmdzOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAvLyDojrflj5bnlKjmiLfmrYzljZUKICAgICAgICAgICAgICBnZXRVc2VyUGxheUxpc3QodGhpcy4kc3RvcmUuc3RhdGUucHJvZmlsZS51c2VySWQpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHJlcy5kYXRhLnBsYXlsaXN0KSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnBsYXlMaXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgIGNvdmVySW1nVXJsOiBpdGVtLmNvdmVySW1nVXJsLAogICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgICAgICAgICBpZDogaXRlbS5pZCwKICAgICAgICAgICAgICAgICAgICBwbGF5Q291bnQ6IGl0ZW0ucGxheUNvdW50LAogICAgICAgICAgICAgICAgICAgIHRyYWNrQ291bnQ6IGl0ZW0udHJhY2tDb3VudCwKICAgICAgICAgICAgICAgICAgICBjcmVhdG9yOiBpdGVtLmNyZWF0b3Iubmlja25hbWUsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRoaXMuJGxvYWRpbmcubG9hZGluZ05vKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy4kdG9hc3Quc2hvdygi5a+G56CB6ZSZ6K+v77yBIiwgMTkwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICAoZXJyKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHRvYXN0LnNob3coIue9kee7nOWHuumUme+8gSIsIDE5MDApOwogICAgICAgICAgfQogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kdG9hc3Quc2hvdygi5omL5py65Y+35LiN6KeE6IyDIiwgMTkwMCk7CiAgICAgIH0KICAgIH0sCgogICAgLy8g5YWz6Zet5omL5py655m75b2V6aG16Z2iCiAgICBiYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgfSwKCiAgICAvLyDlhbPpl63ms6jlhozpobXpnaIKICAgIGNsb3NlUmVnaXN0ZXIoKSB7CiAgICAgIHRoaXMuUmVnaXN0ZXJTaG93ID0gZmFsc2U7CiAgICB9LAogIH0sCiAgY29tcG9uZW50czogewogICAgbmF2YmFyLAogICAgUmVnaXN0ZXIsCiAgfSwKfTsK"},{"version":3,"sources":["PhoneLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PhoneLogin.vue","sourceRoot":"src/components/context/phoneLogin","sourcesContent":["<template>\n  <div class=\"PhoneLogin\">\n    <navbar class=\"navbar\">\n      <div @click=\"back\" class=\"left\" slot=\"left\">\n        <img src=\"~assets/img/myMessage/fanhui.png\" alt=\"\" />\n      </div>\n      <div class=\"title\" slot=\"center\">手机号登陆</div>\n    </navbar>\n    <div class=\"box\">\n      <div class=\"tip\"><span>没有注册过的手机号会自动注册</span></div>\n      <div class=\"content\">\n        <div class=\"tel\">\n          <div class=\"text\">\n            <span>手机号：</span>\n          </div>\n          <div class=\"input\">\n            <input v-model=\"tel\" type=\"text\" placeholder=\"请输入手机号码\" />\n          </div>\n        </div>\n        <div class=\"pwd\">\n          <div class=\"text\">\n            <span>密码：</span>\n          </div>\n          <div class=\"input\">\n            <input\n              v-model=\"password\"\n              type=\"password\"\n              placeholder=\"请输入密码\"\n            />\n          </div>\n        </div>\n      </div>\n      <van-button\n        class=\"btn\"\n        color=\"#da231b\"\n        type=\"primary\"\n        block\n        @click=\"login\"\n        >点击登陆</van-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport navbar from \"components/common/navbar/navbar\";\nimport Register from \"components/context/register/Register\";\nimport { phoneLogin, loginState } from \"network/login\"; // 网络请求\n\nimport { getUserDetail, getUserPlayList } from \"network/user\"; // 用户信息\n\nexport default {\n  name: \"PhoneLogin\",\n  data() {\n    return {\n      tel: \"\", // 手机号\n      password: \"\", // 密码\n    };\n  },\n  methods: {\n    close() {\n      this.$router.go(-1);\n    },\n    // 登陆\n    login() {\n      var reg = /^1[3-8][0-9]{9}$/;\n      if (reg.test(this.tel)) {\n        this.$loading.loadingShow();\n        phoneLogin(this.tel, this.password).then(\n          (res) => {\n            this.$store.state.cookie = res.data.cookie;\n            if (res.data.code === 200) {\n              this.$toast.show(\"登录成功！\", 1900);\n              this.$router.go(-2);\n              this.$store.state.profile.nickName = res.data.profile.nickname; // 用户名\n              this.$store.state.profile.avatarUrl = res.data.profile.avatarUrl; // 头像\n              this.$store.state.profile.userId = res.data.profile.userId; // id\n              this.$store.state.profile.backgroundUrl =\n                res.data.profile.backgroundUrl; // 背景图\n\n              this.tel = \"\";\n              this.password = \"\";\n              getUserDetail(this.$store.state.profile.userId).then((res) => {\n                this.$store.state.profile.level = res.data.level;\n                this.$store.state.profile.listenSongs = res.data.listenSongs;\n              });\n\n              // 获取用户歌单\n              getUserPlayList(this.$store.state.profile.userId).then((res) => {\n                for (const item of res.data.playlist) {\n                  this.$store.state.playList.push({\n                    coverImgUrl: item.coverImgUrl,\n                    name: item.name,\n                    id: item.id,\n                    playCount: item.playCount,\n                    trackCount: item.trackCount,\n                    creator: item.creator.nickname,\n                  });\n                }\n              });\n              this.$loading.loadingNo();\n            } else {\n              this.$toast.show(\"密码错误！\", 1900);\n            }\n          },\n          (err) => {\n            this.$toast.show(\"网络出错！\", 1900);\n          }\n        );\n      } else {\n        this.$toast.show(\"手机号不规范\", 1900);\n      }\n    },\n\n    // 关闭手机登录页面\n    back() {\n      this.$router.go(-1);\n    },\n\n    // 关闭注册页面\n    closeRegister() {\n      this.RegisterShow = false;\n    },\n  },\n  components: {\n    navbar,\n    Register,\n  },\n};\n</script>\n<style scoped>\n.content {\n  padding: 0 10px;\n  height: 90px;\n  font-size: 15px;\n}\n.title {\n  font-size: 0.426099rem;\n}\n.tel {\n  width: 100%;\n  height: 40px;\n  display: flex;\n  border-bottom: 1px solid #cdcdcd;\n  margin-top: 5px;\n  z-index: 10;\n}\n.pwd {\n  width: 100%;\n  height: 40px;\n  display: flex;\n  border-bottom: 1px solid #cdcdcd;\n  margin-top: 5px;\n  z-index: 10;\n}\n.text {\n  flex: 2;\n  line-height: 45px;\n}\n.text span {\n  float: right;\n}\n.input {\n  flex: 7;\n  /* line-height: 45px; */\n  margin-top: 4.1px;\n}\n.input input {\n  height: 35px;\n  border: 0;\n}\n.PhoneLogin {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #fff;\n  z-index: 52;\n}\n.box {\n  padding: 5px 10px;\n}\n.navbar {\n  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.5);\n}\n.left img {\n  width: 20px;\n  height: 20px;\n  margin-top: 12px;\n}\n.btn {\n  margin-top: 10px;\n  border-radius: 44px;\n  font-size: 0.426099rem;\n}\n.tip {\n  font-size: 13px;\n  text-align: center;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  color: #888888;\n}\n.v-enter {\n  opacity: 0;\n  /* 进来的时候从右 */\n  transform: translateX(100%);\n}\n.v-leave-to {\n  opacity: 0;\n  /* 离开的时候向左 */\n  transform: translateX(-100%);\n  position: absolute;\n}\n\n/* 动画执行期间 */\n.v-enter-active,\n.v-leave-active {\n  /* 添加动画效果 */\n  transition: all 0.2s linear;\n}\n</style>"]}]}